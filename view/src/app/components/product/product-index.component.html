<!-- HEADER -->
<app-header></app-header>

<div class="main-wrapper py-4 bg-light min-vh-100">
  <div class="container">

    <!-- ================= TOP SECTION ================= -->
    <div class="row g-3 mb-4">

      <!-- CATEGORY -->
      <aside class="col-lg-3 d-none d-lg-block">
        <div class="bg-white rounded shadow-sm h-100">
          <h6 class="fw-bold p-3 border-bottom m-0">
            üìÇ DANH M·ª§C S·∫¢N PH·∫®M
          </h6>

          <ul class="list-unstyled m-0 p-2 category-list">
            <li
              (click)="filterByCategory(null)"
              [class.active]="selectedCategory === 0">
              üì± T·∫•t c·∫£ s·∫£n ph·∫©m
            </li>

            <li
              *ngFor="let c of categories"
              (click)="filterByCategory(c.id ?? 0)"
              [class.active]="selectedCategory === c.id">
              üîπ {{ c.name }}
            </li>
          </ul>
        </div>
      </aside>

      <!-- SLIDER -->
      <section class="col-lg-6 col-md-12">
        <div
          id="promoCarousel"
          class="carousel slide shadow-sm rounded overflow-hidden mb-2"
          data-bs-ride="carousel"
          data-bs-interval="3000">

          <div class="carousel-indicators">
            <button
              *ngFor="let img of sliderImages; let i = index"
              type="button"
              data-bs-target="#promoCarousel"
              [attr.data-bs-slide-to]="i"
              [class.active]="i === 0">
            </button>
          </div>

          <div class="carousel-inner">
            <div
              *ngFor="let img of sliderImages; let i = index"
              class="carousel-item"
              [class.active]="i === 0">
              <img [src]="img" class="d-block w-100">
            </div>
          </div>
        </div>

        <div class="row g-2">
          <div class="col-6" *ngFor="let subImg of subBanners">
            <img [src]="subImg" class="img-fluid rounded shadow-sm">
          </div>
        </div>
      </section>

<!-- PROMOTION -->
<aside class="col-lg-3 d-none d-lg-block">
  <div class="bg-white rounded shadow-sm h-100 p-3 promotion-box">

    <div class="promotion-title mb-3">
      <span class="dot"></span>
      <span class="text-danger fw-bold text-uppercase">∆Øu ƒë√£i hot</span>
    </div>

    <ul class="promotion-list">
      <li>
        <span class="promo-badge badge-new">NEW</span>
        Thu c≈© l√™n ƒë·ªùi ‚Äì Tr·ª£ gi√° 1tr
      </li>
      <li>
        <span class="promo-badge badge-hot">HOT</span>
        Gi·∫£m 50% g√≥i b·∫£o h√†nh
      </li>
      <li>
        <span class="promo-badge badge-sale">SALE</span>
        Ph·ª• ki·ªán mua k√®m gi·∫£m 20%
      </li>
      <li>
        <span class="promo-badge badge-vip">VIP</span>
        Tr·∫£ g√≥p 0% l√£i su·∫•t
      </li>
    </ul>

    <!-- Logo nh·ªè d∆∞·ªõi c√πng -->
    <div class="promo-logo">
      <div class="logo-box">S</div>
    </div>

  </div>
</aside>

    </div>

    <!-- ================= PRODUCT LIST ================= -->
    <section>

      <h5 class="fw-bold text-uppercase mb-3">
        S·∫£n ph·∫©m n·ªïi b·∫≠t
      </h5>

      <div *ngIf="products.length > 0; else loading" class="row g-3">

        <div
          *ngFor="let product of products"
          class="col-xl-2 col-lg-3 col-md-4 col-6">

          <div class="product-card">

            <!-- DISCOUNT -->
            <span class="discount-badge">-15%</span>

            <!-- IMAGE -->
            <div class="product-image" (click)="viewProduct(product.id)">
              <img [src]="getMainImage(product)" alt="{{ product.name }}">
            </div>

            <!-- NAME -->
            <div class="product-name">
              {{ product.name }}
            </div>

            <!-- PRICE -->
            <div class="price-box">
              <div class="price-new">
                {{ product.price | currency:'VND' }}
              </div>
              <div class="price-old">
                {{ product.price * 1.15 | currency:'VND' }}
              </div>
            </div>

            <!-- STATUS -->
            <span
              *ngIf="(product.quantity ?? 0) <= 0"
              class="status-out">
              ‚úñ H·∫øt h√†ng
            </span>

            <!-- QTY -->
            <div class="qty-box">
              <span>SL:</span>
              <input type="number" value="1" disabled>
            </div>

            <!-- BUTTONS -->
            <button
              class="btn-cart"
              [disabled]="(product.quantity ?? 0) <= 0">
              üõí Th√™m v√†o gi·ªè h√†ng
            </button>

            <button
              class="btn-detail"
              (click)="viewProduct(product.id)">
              Xem chi ti·∫øt
            </button>

          </div>
        </div>

      </div>
    </section>

  </div>
</div>

<!-- LOADING -->
<ng-template #loading>
  <div class="text-center py-5">
    <div class="spinner-border text-danger"></div>
    <p class="mt-2 text-muted">ƒêang t·∫£i s·∫£n ph·∫©m...</p>
  </div>
</ng-template>
